<!-- Close Button -->
<button pButton 
  icon="pi pi-times" 
  class="close-button p-button-rounded p-button-text"
  (click)="goBack()"
  aria-label="Close">
</button>

<div class="movie-details" *ngIf="movie">
  <div class="movie" [ngStyle]="{'background-image': movie.backdropUrl ? 'url(' + movie.backdropUrl + ')' : 'none'}">
    <div class="movie-overlay"></div>
    <div class="movie-content">
      <div class="poster">
        @if (movie.posterUrl) {
          <img [src]="movie.posterUrl" [alt]="movie.title" />
        } @else {
          <div class="no-image">
            <i class="pi pi-image"></i>
          </div>
        }
      </div>
      <div class="info">
        <div class="header">
          <h1>{{ movie.title }}</h1>
          <div class="actions">
            <button pButton 
              [icon]="isFavorite ? 'pi pi-heart-fill' : 'pi pi-heart'"
              class="p-button-rounded"
              [class.p-button-danger]="isFavorite"
              (click)="toggleFavorite()">
            </button>
            <button pButton 
              [icon]="isWishlist ? 'pi pi-bookmark-fill' : 'pi pi-bookmark'"
              class="p-button-rounded"
              [class.p-button-info]="isWishlist"
              (click)="toggleWishlist()">
            </button>
          </div>
        </div>
        <div class="meta">
          <div class="meta-row">
            <span class="rating">
              <i class="pi pi-star-fill"></i>
              {{ movie.rating | number:'1.1-1' }} /10
            </span>
            <span class="separator">•</span>
            <span>{{ movie.year }}</span>
            <span class="separator">•</span>
            <span>{{ movie.runtime }} min</span>
          </div>
          <div class="meta-row genres">
            @for (genre of movie.genres; track genre.id) {
              <p-chip 
                [label]="genre.name"
                [removable]="false"
                (click)="onGenreClick(genre)"
                styleClass="genre-chip">
              </p-chip>
            }
          </div>
        </div>

        <div class="overview">
          <h2>Overview</h2>
          <p>{{ movie.overview }}</p>
        </div>

        <div class="details-grid">
          @for (detail of movieDetails; track detail.label) {
            <div class="detail-item">
              <label>{{ detail.label }}</label>
              <span>{{ detail.value }}</span>
            </div>
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Cast Section -->
  <div class="content">
    <section class="cast" *ngIf="movie.credits.cast?.length">
      <h2>Top Cast</h2>
      <p-carousel 
        [value]="movie.credits.cast" 
        [numVisible]="6"
        [numScroll]="1"
        [circular]="false"
        [responsiveOptions]="responsiveOptions"
        [showIndicators]="false">
        <ng-template let-member pTemplate="item">
          <div class="carousel-item">
            <app-cast-member [member]="member" />
          </div>
        </ng-template>
      </p-carousel>
    </section>
  </div>
</div> 